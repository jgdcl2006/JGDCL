<!--
Simple Game Library - Admin-Enabled

How to use:
- Save this file as `index.html` and open in a browser (double-click) to run locally.
- First time you open it, you'll be solicitado a criar uma senha de admin. Essa senha será armazenada localmente (hash) para proteger a área de administração.
- Admin pode adicionar, editar, excluir jogos. Visitantes (não logados) só veem a lista e não conseguem modificar nada.
- Dados (lista de jogos) são salvos no localStorage do navegador (persistente nesse navegador/computador). Use Export/Import JSON para mover a biblioteca entre computadores.

Security notes:
- Esta proteção é "client-side" (no navegador). Se você hospedar o arquivo publicamente, alguém com acesso ao arquivo HTML pode alterar o código. Para proteção real (multi-device, compartilhada, segura), seria necessário um backend com autenticação.
- Esta solução é prática para ter um site local/estático com uma área de administração simples.
-->

<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Biblioteca de Jogos (Admin)</title>
  <style>
    :root{--bg:#071022;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;--glass:rgba(255,255,255,0.04)}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#071023 0%, #08121a 100%);color:#e6eef6}
    header{padding:18px 20px;border-bottom:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;gap:12px}
    h1{font-size:18px;margin:0}
    .container{max-width:1000px;margin:24px auto;padding:0 16px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}
    .card{background:var(--card);padding:12px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03);cursor:pointer;transition:transform .12s ease,box-shadow .12s ease}
    .card:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(2,6,23,0.7)}
    .thumb{height:120px;border-radius:8px;object-fit:cover;width:100%;background:var(--glass);display:block}
    .meta{margin-top:8px}
    .title{font-weight:600;margin:0 0 6px 0;font-size:15px}
    .small{color:var(--muted);font-size:13px}
    .empty{padding:40px;text-align:center;color:var(--muted)}

    /* overlay */
    .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:60;padding:20px}
    .overlay.show{display:flex}
    .panel{width:100%;max-width:820px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.04)}
    .panel-top{display:flex;gap:16px}
    .panel img{width:260px;height:150px;object-fit:cover;border-radius:8px}
    .panel-info{flex:1}
    .panel h2{margin:0 0 6px 0}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:var(--accent);color:#042024;text-decoration:none;font-weight:700;margin-right:8px}
    .btn.secondary{background:none;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .close{background:none;border:none;color:var(--muted);font-size:18px;padding:6px;border-radius:8px}
    .top-actions{margin-left:auto;display:flex;gap:8px;align-items:center}

    /* search */
    .search{margin-left:16px;flex:1;max-width:420px}
    .search input{width:100%;padding:10px 12px;border-radius:999px;border:none;background:rgba(255,255,255,0.03);color:inherit}

    /* admin panel */
    .admin-bar{display:flex;gap:8px;align-items:center;margin-left:16px}
    .input, input, textarea{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:inherit}
    .admin-panel{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;margin-bottom:18px;border:1px solid rgba(255,255,255,0.03)}

    @media (max-width:700px){.panel-top{flex-direction:column}.panel img{width:100%;height:200px}}
  </style>
</head>
<body>
  <header>
    <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="6" fill="#05202A"/><path d="M7 12h10M7 8h10M7 16h6" stroke="#06b6d4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    <h1>Biblioteca de Jogos</h1>
    <div class="search" aria-hidden>
      <input id="search" placeholder="Buscar jogos... (ex: futebol)" />
    </div>
    <div class="top-actions">
      <div class="admin-bar" id="adminBar">
        <button id="btnLogin" class="close">Login Admin</button>
        <button id="btnLogout" class="close" style="display:none">Logout</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div id="adminPanelWrap" style="display:none;margin-bottom:12px">
      <div class="admin-panel">
        <strong>Painel Admin</strong>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
          <button id="openAdd" class="btn">Adicionar Jogo</button>
          <button id="exportBtn" class="btn secondary">Exportar JSON</button>
          <button id="importBtn" class="btn secondary">Importar JSON</button>
          <button id="resetBtn" class="btn secondary">Apagar Tudo</button>
          <span style="margin-left:auto;color:var(--muted);font-size:13px">Logado como Admin</span>
        </div>
      </div>
    </div>

    <div id="list" class="grid"></div>
    <div id="empty" class="empty" style="display:none">Nenhum jogo encontrado. Faça login como admin para adicionar jogos.</div>
  </main>

  <!-- Detail overlay -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
    <div class="panel">
      <div style="display:flex;align-items:center;margin-bottom:12px">
        <h2 id="pTitle" style="margin:0">Título do Jogo</h2>
        <div style="flex:1"></div>
        <button class="close" id="btnClose">✕</button>
      </div>
      <div class="panel-top">
        <img id="pImage" src="" alt="Capa do jogo"/>
        <div class="panel-info">
          <p id="pDesc" class="small" style="margin-top:0">Descrição (opcional)</p>
          <div style="margin-top:18px">
            <a id="pLink" class="btn" href="#" target="_blank" rel="noopener noreferrer">Abrir Link</a>
            <button class="btn secondary" id="pClose">Fechar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Edit modal (admin) -->
  <div id="modalAdmin" class="overlay">
    <div class="panel" style="max-width:520px">
      <div style="display:flex;align-items:center;margin-bottom:12px">
        <h2 id="mTitle" style="margin:0">Adicionar Jogo</h2>
        <div style="flex:1"></div>
        <button class="close" id="btnCloseAdmin">✕</button>
      </div>
      <div style="display:flex;flex-direction:column;gap:8px">
        <input id="mName" class="input" placeholder="Nome do jogo" />
        <input id="mImage" class="input" placeholder="URL da imagem (ou caminho local)" />
        <input id="mUrl" class="input" placeholder="URL do download/link" />
        <textarea id="mDesc" class="input" placeholder="Descrição (opcional)" rows="3"></textarea>
        <div style="display:flex;gap:8px">
          <button id="saveGame" class="btn">Salvar</button>
          <button id="cancelGame" class="btn secondary">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin login modal -->
  <div id="modalLogin" class="overlay">
    <div class="panel" style="max-width:420px">
      <div style="display:flex;align-items:center;margin-bottom:12px">
        <h2 style="margin:0">Área Admin</h2>
        <div style="flex:1"></div>
        <button class="close" id="closeLogin">✕</button>
      </div>
      <div style="display:flex;flex-direction:column;gap:8px">
        <div id="loginCreateNote" class="small" style="color:var(--muted)"></div>
        <input id="adminPass" class="input" placeholder="Senha admin" type="password" />
        <div style="display:flex;gap:8px">
          <button id="doLogin" class="btn">Entrar</button>
          <button id="doCreate" class="btn secondary" style="display:none">Criar senha</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Storage keys
    const STORAGE_KEY = 'gameLibrary_games_v1';
    const ADMIN_HASH_KEY = 'gameLibrary_admin_hash_v1';

    // Elements
    const listEl = document.getElementById('list');
    const emptyEl = document.getElementById('empty');
    const overlay = document.getElementById('overlay');
    const pTitle = document.getElementById('pTitle');
    const pImage = document.getElementById('pImage');
    const pDesc = document.getElementById('pDesc');
    const pLink = document.getElementById('pLink');

    const adminPanelWrap = document.getElementById('adminPanelWrap');
    const btnLogin = document.getElementById('btnLogin');
    const btnLogout = document.getElementById('btnLogout');

    const modalAdmin = document.getElementById('modalAdmin');
    const mTitle = document.getElementById('mTitle');
    const mName = document.getElementById('mName');
    const mImage = document.getElementById('mImage');
    const mUrl = document.getElementById('mUrl');
    const mDesc = document.getElementById('mDesc');
    const saveGame = document.getElementById('saveGame');
    const cancelGame = document.getElementById('cancelGame');

    const modalLogin = document.getElementById('modalLogin');
    const adminPass = document.getElementById('adminPass');
    const doLogin = document.getElementById('doLogin');
    const doCreate = document.getElementById('doCreate');
    const loginCreateNote = document.getElementById('loginCreateNote');

    // Admin state
    let isAdmin = false;
    let editingId = null;

    // Utils: hash using SubtleCrypto (SHA-256 -> hex)
    async function sha256hex(str){
      const enc = new TextEncoder();
      const data = enc.encode(str);
      const hash = await crypto.subtle.digest('SHA-256', data);
      return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');
    }

    // Load games from storage
    function loadGames(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY) || '[]';
        const arr = JSON.parse(raw);
        if (Array.isArray(arr)) return arr; else return [];
      }catch(e){return []}
    }

    function saveGames(arr){ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }

    // Render list
    function render(){
      const q = document.getElementById('search').value.trim().toLowerCase();
      const items = loadGames().filter(g => g.title.toLowerCase().includes(q));
      listEl.innerHTML = '';
      if (!items.length) { emptyEl.style.display = 'block'; return; } else emptyEl.style.display = 'none';

      for (const g of items){
        const card = document.createElement('div');
        card.className = 'card';
        card.tabIndex = 0;
        card.innerHTML = `
          <img src="${escapeHtml(g.image||'')}" class="thumb" alt="${escapeHtml(g.title)}" onerror="this.src='https://via.placeholder.com/640x360.png?text=Sem+imagem'" />
          <div class=\"meta\">
            <p class=\"title\">${escapeHtml(g.title)}</p>
            <p class=\"small\">Clique para ver detalhes</p>
          </div>
        `;
        card.addEventListener('click', ()=> openDetail(g));

        // If admin, add small edit/delete buttons overlay
        if (isAdmin){
          const tools = document.createElement('div');
          tools.style.position = 'absolute';
          tools.style.right = '14px';
          tools.style.top = '12px';
          tools.style.display = 'flex';
          tools.style.gap = '6px';

          const bEdit = document.createElement('button');
          bEdit.textContent = '✎';
          bEdit.title = 'Editar';
          bEdit.className = 'close';
          bEdit.style.zIndex = 40;
          bEdit.addEventListener('click', (ev)=>{ ev.stopPropagation(); startEdit(g.id); });

          const bDel = document.createElement('button');
          bDel.textContent = '🗑';
          bDel.title = 'Excluir';
          bDel.className = 'close';
          bDel.style.zIndex = 40;
          bDel.addEventListener('click', (ev)=>{ ev.stopPropagation(); deleteGame(g.id); });

          tools.appendChild(bEdit); tools.appendChild(bDel);
          card.style.position = 'relative';
          card.appendChild(tools);
        }

        listEl.appendChild(card);
      }
    }

    function openDetail(g){
      pTitle.textContent = g.title;
      pImage.src = g.image || 'https://via.placeholder.com/640x360.png?text=Sem+imagem';
      pDesc.textContent = g.desc || 'Sem descrição.';
      pLink.href = g.url || '#';
      overlay.classList.add('show');
    }

    document.getElementById('btnClose').addEventListener('click', ()=> overlay.classList.remove('show'));
    document.getElementById('pClose').addEventListener('click', ()=> overlay.classList.remove('show'));
    document.getElementById('search').addEventListener('input', render);

    // Admin actions
    btnLogin.addEventListener('click', ()=> showLogin());
    document.getElementById('closeLogin').addEventListener('click', ()=> closeLogin());
    document.getElementById('btnCloseAdmin').addEventListener('click', ()=> modalAdmin.classList.remove('show'));
    document.getElementById('openAdd').addEventListener('click', ()=> openAdd());
    document.getElementById('cancelGame').addEventListener('click', ()=> modalAdmin.classList.remove('show'));

    document.getElementById('exportBtn').addEventListener('click', ()=> exportJSON());
    document.getElementById('importBtn').addEventListener('click', ()=> importJSON());
    document.getElementById('resetBtn').addEventListener('click', ()=>{ if(confirm('Apagar todos os jogos?')){ saveGames([]); render(); } });

    btnLogout.addEventListener('click', ()=>{ doLogout(); });

    // Save / Add
    saveGame.addEventListener('click', ()=>{
      const name = mName.value.trim();
      if (!name) return alert('Digite o nome do jogo');
      const image = mImage.value.trim() || '';
      const url = mUrl.value.trim() || '';
      const desc = mDesc.value.trim() || '';
      const arr = loadGames();
      if (editingId){
        const idx = arr.findIndex(x=>x.id===editingId);
        if (idx>=0){ arr[idx] = { id: editingId, title: name, image, url, desc }; }
      } else {
        const id = 'g'+Date.now();
        arr.unshift({ id, title: name, image, url, desc });
      }
      saveGames(arr);
      modalAdmin.classList.remove('show');
      clearModal();
      render();
    });

    function clearModal(){ editingId = null; mTitle.textContent = 'Adicionar Jogo'; mName.value=''; mImage.value=''; mUrl.value=''; mDesc.value=''; }

    function openAdd(){ clearModal(); modalAdmin.classList.add('show'); }
    function startEdit(id){ const arr = loadGames(); const g = arr.find(x=>x.id===id); if(!g) return alert('Jogo não encontrado'); editingId = id; mTitle.textContent = 'Editar Jogo'; mName.value=g.title; mImage.value=g.image||''; mUrl.value=g.url||''; mDesc.value=g.desc||''; modalAdmin.classList.add('show'); }

    function deleteGame(id){ if(!confirm('Excluir esse jogo?')) return; const arr = loadGames().filter(x=>x.id!==id); saveGames(arr); render(); }

    // Export / Import
    function exportJSON(){ const arr = loadGames(); const blob = new Blob([JSON.stringify(arr, null, 2)], {type:'application/json'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='games_export.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); }

    function importJSON(){ const inp = document.createElement('input'); inp.type='file'; inp.accept='application/json'; inp.onchange = e=>{ const f = e.target.files[0]; if(!f) return; const reader = new FileReader(); reader.onload = ()=>{ try{ const data = JSON.parse(reader.result); if(!Array.isArray(data)) return alert('JSON inválido'); if(confirm('Substituir a lista atual pelos dados do arquivo?')){ saveGames(data); render(); alert('Importado!'); } }catch(err){ alert('Erro ao ler JSON'); } }; reader.readAsText(f); }; inp.click(); }

    // Admin login flow
    async function showLogin(){
      const storedHash = localStorage.getItem(ADMIN_HASH_KEY);
      if (!storedHash){
        // no admin yet -> create
        loginCreateNote.textContent = 'Nenhuma senha encontrada. Crie uma senha de admin para proteger o painel (será salva neste navegador).';
        doCreate.style.display = 'inline-block';
        doLogin.style.display = 'none';
      } else {
        loginCreateNote.textContent = 'Digite sua senha de admin para acessar o painel.';
        doCreate.style.display = 'none';
        doLogin.style.display = 'inline-block';
      }
      adminPass.value='';
      modalLogin.classList.add('show');
    }

    function closeLogin(){ modalLogin.classList.remove('show'); }

    doCreate.addEventListener('click', async ()=>{
      const pass = adminPass.value.trim(); if(!pass) return alert('Digite uma senha');
      const h = await sha256hex(pass);
      localStorage.setItem(ADMIN_HASH_KEY, h);
      alert('Senha criada! Agora faça login.');
      modalLogin.classList.remove('show');
    });

    doLogin.addEventListener('click', async ()=>{
      const pass = adminPass.value.trim(); if(!pass) return alert('Digite a senha');
      const h = await sha256hex(pass);
      const stored = localStorage.getItem(ADMIN_HASH_KEY);
      if (h === stored){ enableAdmin(); modalLogin.classList.remove('show'); adminPass.value=''; } else alert('Senha incorreta');
    });

    function enableAdmin(){ isAdmin = true; adminPanelWrap.style.display='block'; btnLogin.style.display='none'; btnLogout.style.display='inline-block'; render(); }
    function doLogout(){ isAdmin = false; adminPanelWrap.style.display='none'; btnLogin.style.display='inline-block'; btnLogout.style.display='none'; render(); }

    // On load: initial sample if empty
    (function init(){
      try{
        const current = loadGames();
        if (!current.length){
          // initial sample
          const sample = [
            { id:'g_sample1', title:'Jogo Exemplo', image:'https://via.placeholder.com/640x360.png?text=Jogo+Exemplo', url:'https://example.com', desc:'Jogo de exemplo.' }
          ];
          saveGames(sample);
        }
      }catch(e){/*ignore*/}
      render();
    })();

    // helper
    function escapeHtml(text){ return String(text||'').replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[m]; }); }
  </script>
</body>
</html>
